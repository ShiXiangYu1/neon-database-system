# Vercel部署指南

本文档提供了将Neon数据库系统部署到Vercel的详细说明。

## 部署前准备

1. 已经对代码进行了必要的修改，使其能在Vercel的无服务器环境中运行。
2. 已经创建了Neon PostgreSQL数据库实例，并获取了连接字符串。

## 部署步骤

### 1. 创建Vercel账户

如果还没有Vercel账户，请先注册一个：https://vercel.com/signup

### 2. 导入GitHub项目

1. 登录Vercel账户
2. 点击"Add New Project"
3. 选择要导入的GitHub仓库
4. 如果没有看到你的仓库，点击"Configure GitHub App"并授权Vercel访问你的仓库

### 3. 配置项目

在配置页面中：

- **项目名称**：填写你喜欢的名称，如`neon-database-system`
- **框架预设**：选择"Other"
- **根目录**：保持默认值`.`
- **构建命令**：`npm install`
- **输出目录**：留空

### 4. 环境变量设置

点击"Environment Variables"添加以下环境变量：

- `DATABASE_URL`: 你的Neon PostgreSQL连接字符串
- `JWT_SECRET`: 一个长且复杂的随机字符串作为JWT密钥
- `PORT`: 设置为`8080`
- `VERCEL`: 设置为`1`

### 5. 部署项目

点击"Deploy"按钮开始部署。部署完成后，Vercel会提供一个域名访问你的应用。

## 注意事项

### 文件上传功能

Vercel是无服务器架构，无法永久存储上传的文件。我们已经修改代码以使用`/tmp`目录，但有以下限制：

1. 上传的文件仅在函数执行期间存在
2. 文件大小限制为50MB
3. 长时间未访问的文件可能会被自动删除

对于生产环境，建议使用AWS S3或其他云存储服务来存储上传的文件。

### 数据库连接

确保你的Neon数据库允许从所有IP地址连接，因为Vercel函数可能从不同的IP地址发起连接。

### 其他考虑因素

1. Vercel函数有10秒的执行时间限制，长时间运行的操作可能会超时
2. 每个函数实例的内存限制为1024MB
3. 冷启动可能导致第一次请求较慢

## 排查问题

如果部署后遇到问题：

1. 查看Vercel的部署日志和函数日志
2. 检查浏览器控制台中的错误信息
3. 验证环境变量是否正确设置
4. 确保数据库连接正常

## 更新部署

当你更新代码并推送到GitHub时，Vercel会自动重新部署你的应用。 